<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" src="assets/stylesheets/main.css">
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');

        /*Creates header section */
        var $header = $('<header class="container header"></header>');
        $header.appendTo($body); 

        var $logo = $('<header class="container header"><h1 class="logo">Twittler</h1></header>');
        $logo.appendTo($header);

        /* Creates section for tweet feed */

        var $tweetContainer = $('<section class="mainFeed"></section>');
        $tweetContainer.appendTo($body);

        /* Creates section for users individual feeds */
        var $usersFeed = $('<section class="usersFeed"></section>');
        $usersFeed.appendTo($body);

        var index = 0;

        /* Add tweet utility function */
        var addTweet = function(element, tweet){
          var tweet = streams.home[index];
          var $tweet = $('<div class="tweet"></div>');
          $tweet.html('@<a href="#" class="tweetUser" ' + 'id="' + tweet.user + '">' + tweet.user + '</a>: ' + tweet.message + ' - ' + tweet.created_at);
          $tweet.prependTo(element);
          $('.tweetUser').on('click', showUserFeed);
        };

        /* Shows user's timline when username is clicked */
        var showUserFeed = function() {
          index = 0;
          $usersFeed.html('');
          var tweet;
          while(index < streams.home.length){
            tweet = streams.home[index];
            if(tweet.user === event.target.id){
              addTweet($usersFeed, tweet);
            }
            index++;
          }
          $newTweets.remove();
          $tweetContainer.html('');
          addBackButton();
        };

        /* Populates initial tweets. */
        var feedUpdate = function() {
          var tweet;
          while(index < streams.home.length){
            tweet = streams.home[index];
            addTweet($tweetContainer, tweet);
            index++;
          }
        };

        feedUpdate();

        /* Allows button to update with next most current tweets -- Maybe find a way to wrap in function like back button to reuse code*/

        var $newTweets = $('<button class="btn">New Tweets</button>');
        $newTweets.appendTo($body);
        $('.btn').on('click', feedUpdate);

        /* Adds button to userFeed to go back to mainFeed */
        var addBackButton = function(){
          var $backButton = $('<button class="btn backButton">Back to Feed</button>');
          $backButton.appendTo($usersFeed);
          $backButton.on('click', function() {
            index = 0;
            feedUpdate();
            $backButton.remove();
            $usersFeed.html(' ');
            $newTweets.appendTo($body);
            $('.btn').on('click', feedUpdate);
          });
        }

      });

    </script>
  </body>
</html>
