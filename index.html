<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" src="assets/stylesheets/main.css">
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');

        /* Creates section for tweet feed */

        var $tweetContainer = $('<section class="mainFeed"></section>');
        $tweetContainer.appendTo($body);

        /* Creates section for users individual feeds */
        var $usersFeed = $('<section class="usersFeed"></section>');
        $usersFeed.addClass('invisible');
        $usersFeed.appendTo($body);

        var index = 0;

        /* Add tweet function */
        var addTweet = function(element, tweet){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          $tweet.html('@<a href="#" class="tweetUser" ' + 'id="' + tweet.user + '">' + tweet.user + '</a>: ' + tweet.message + ' - ' + tweet.created_at);
          $tweet.prependTo(element);
        };

        /* Populates initial tweets. */
        var feedUpdate = function() {
          var tweet;
          while(index < streams.home.length){
            tweet = streams.home[index];
            addTweet($tweetContainer, tweet);
            index++;
          }
        };

        feedUpdate();

        /* Allows button to update with next most current tweets*/
        index = streams.home.length;

        var $button = $('<button class="btn">New Tweets</button>');
        $button.appendTo($body);

        $('.btn').on('click', feedUpdate);

        /* Shows user's timline */
        var showFeed = function() {
          index = 0;
          $usersFeed.html('');
          var tweet;
          while(index < streams.home.length){
            tweet = streams.home[index];
            if(tweet.user = event.target.id)
              addTweet($usersFeed, tweet);
              index++;
          }
          $tweetContainer.addClass('invisible');
          $tweetContainer.find('div').addClass('invisible');
          $button.remove();
          $usersFeed.removeClass('invisible');
          $tweetContainer.html('');
        };

        $('.tweetUser').on('click', showFeed);

      });

    </script>
  </body>
</html>
